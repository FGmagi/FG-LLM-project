<!DOCTYPE html>
<html>
<head>
    <title>æœå†œåŠ©æ‰‹ - æ™ºèƒ½å†œä¸šå’¨è¯¢ç³»ç»Ÿ</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>æœå†œåŠ©æ‰‹</h1>
            <p>æ™ºèƒ½å†œä¸šå’¨è¯¢ç³»ç»Ÿ</p>
            <div class="status-indicator disconnected" id="statusIndicator">
                â— åç«¯æœåŠ¡æœªè¿æ¥
            </div>
        </div>
        
        <div class="chat-container">
            <div class="chat-box" id="chatBox">
                <!-- æ¬¢è¿æ¶ˆæ¯å°†é€šè¿‡AIå›å¤æ˜¾ç¤º -->
            </div>
            
            <div class="input-container">
                <input type="text" id="userInput" placeholder="è¯·è¾“å…¥æ‚¨çš„é—®é¢˜...">
                <button onclick="sendMessage()">å‘é€</button>
            </div>
            
            <div class="quick-actions">
                <button class="quick-action-btn" onclick="quickAction('æµ‡æ°´çŒæº‰')">ğŸ’§ æµ‡æ°´çŒæº‰</button>
                <button class="quick-action-btn" onclick="quickAction('å¦‚ä½•æ–½è‚¥ï¼Ÿ')">ğŸŒ¿ å¦‚ä½•æ–½è‚¥ï¼Ÿ</button>
                <button class="quick-action-btn" onclick="quickAction('æ¸©åº¦æ€ä¹ˆæ ·ï¼Ÿ')">ğŸŒ¡ï¸ æ¸©åº¦ç®¡ç†</button>
                <button class="quick-action-btn" onclick="quickAction('ç—…è™«å®³é˜²æ²»')">ğŸ› ç—…è™«å®³é˜²æ²»</button>
                <button class="quick-action-btn" onclick="quickAction('åœŸå£¤ç®¡ç†')">ğŸ§ª åœŸå£¤ç®¡ç†</button>
            </div>
        </div>
    </div>
    
    <script>
        // åˆå§‹åŒ–çŠ¶æ€å’Œæ¬¢è¿æ¶ˆæ¯
        document.addEventListener('DOMContentLoaded', function() {
            // æ¨¡æ‹Ÿè¿æ¥æˆåŠŸ
            setTimeout(() => {
                const statusIndicator = document.getElementById('statusIndicator');
                
                statusIndicator.textContent = 'â— å·²è¿æ¥';
                statusIndicator.className = 'status-indicator connected';
                setTimeout(() => {
                    sendWelcomeMessage();
                }, 500);
                
            }, 1000);
        });
        
        function sendWelcomeMessage() {
            const welcomeMessage = "æ¬¢è¿ä½¿ç”¨æœå†œåŠ©æ‰‹ï¼æˆ‘å¯ä»¥ä¸ºæ‚¨æä¾›æŸ‘æ©˜ç§æ¤çš„æ™ºèƒ½å»ºè®®ã€‚\n\næ‚¨å¯ä»¥ä½¿ç”¨ï¼š\n\"æµ‡æ°´çŒæº‰\"\n\"å¦‚ä½•æ–½è‚¥ï¼Ÿ\"\n\"æ¸©åº¦æ€ä¹ˆæ ·ï¼Ÿ\"\n\"ç—…è™«å®³é˜²æ²»\"\nç³»ç»Ÿæ¶ˆæ¯";
            addMessageToChat('ai', welcomeMessage);
        }
        
        function sendMessage() {
            const input = document.getElementById('userInput');
            const message = input.value.trim();
            if (!message) return;
            
            addMessageToChat('user', message);
            input.value = '';
            
            // å‘é€åˆ°åç«¯
            fetch('/chat', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({message: message})
            })
            .then(response => response.json())
            .then(data => {
                addMessageToChat('ai', data.response);
            })
            .catch(error => {
                addMessageToChat('ai', 'âŒ æŠ±æ­‰ï¼ŒæœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·ç¨åé‡è¯•ã€‚');
            });
        }
        
        function quickAction(action) {
            document.getElementById('userInput').value = action;
            sendMessage();
        }
        
        function addMessageToChat(sender, message) {
            const chatBox = document.getElementById('chatBox');
            const messageDiv = document.createElement('div');
            
            if (sender === 'user') {
                messageDiv.className = 'user-msg';
                messageDiv.textContent = message;
            } else {
                messageDiv.className = 'ai-msg';
                // ä¿ç•™æ¢è¡Œç¬¦
                messageDiv.innerHTML = message.replace(/\n/g, '<br>');
            }
            
            chatBox.appendChild(messageDiv);
            chatBox.scrollTop = chatBox.scrollHeight;
        }
        
        // å›è½¦å‘é€æ¶ˆæ¯
        document.getElementById('userInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
    </script>
</body>
</html>